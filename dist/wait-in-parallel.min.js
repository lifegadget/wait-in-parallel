!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var t=function(e,t,i,s){return new(i||(i=Promise))(function(r,n){function a(e){try{o(s.next(e))}catch(e){n(e)}}function u(e){try{o(s.throw(e))}catch(e){n(e)}}function o(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(a,u)}o((s=s.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});var i=require("./ParallelError"),s=require("./timeout");function r(e){return"function"==typeof e}var n=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{throw:!0};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.options=e,this._tasks=[],this._errors={},this._results={},this._successful=[],this._failed=[],this._registrations={},this._failFast=!1,this._failureCallbacks=[],this._successCallbacks=[],void 0===e.throw&&(e.throw=!0)}var a,u,o;return a=n,o=[{key:"create",value:function(){return new n}}],(u=[{key:"get",value:function(e){if(!new Set(["failed","successful","errors","results","failFast","registrations"]).has(e))throw new Error('"'.concat(e,'" is not a valid property to get.'));return this["_".concat(e)]}},{key:"add",value:function(e,t,i){try{this.register(e,t,{timeout:i})}catch(n){if("NameAlreadyExists"===n.name){if(r(t))throw n;var s=Math.random().toString(36).substr(2,10);console.error('wait-in-parallel: The promise just added as "'.concat(e,'" is a duplicate name to one already being managed but since the Promise is already executing we will give it a new name of "').concat(s,'" and continue to manage it!')),this.register(s,t,{timeout:i})}}return this}},{key:"notifyOnFailure",value:function(e){return this._failureCallbacks.push(e),this}},{key:"notifyOnSuccess",value:function(e){return this._successCallbacks.push(e),this}},{key:"clear",value:function(){return this._tasks=[],this._errors={},this._results={},this._successful=[],this._failed=[],this._registrations={},this._failureCallbacks=[],this._successCallbacks=[],this}},{key:"failFast",value:function(e){return this._failFast=void 0===e||e,this}},{key:"isDone",value:function(){return t(this,void 0,void 0,function*(){if(this.startDelayedTasks(),yield Promise.all(this._tasks),this._failed.length>0)throw new i.default(this);return this._results})}},{key:"register",value:function(e,t,i){var n=this;if(new Set(Object.keys(this._registrations)).has(e)){var a=new Error('There is already a registered item using the name "'.concat(e,'" in your Parallel object. Names must be unique, ignoring new addition.'));throw a.name="NameAlreadyExists",a}if(this._registrations[e]=i,r(t))this._registrations[e].deferred=t;else{var u=i.timeout||0;this._tasks.push(s.default(t,u).then(function(t){return n.handleSuccess(e,t)}).catch(function(t){return n.handleFailure(e,t)}))}}},{key:"handleSuccess",value:function(e,t){this._successful.push(e),this._results[e]=t}},{key:"handleFailure",value:function(e,t){if(this._failed.push(e),this._errors[e]=t,this._failFast)throw new i.default(this)}},{key:"startDelayedTasks",value:function(){var e=this;Object.keys(this._registrations).map(function(t){var i=e._registrations[t];if(i.deferred){var r=i.timeout||0;try{e._tasks.push(s.default(i.deferred(),r).then(function(i){return e.handleSuccess(t,i)}).catch(function(i){return e.handleFailure(t,i)}))}catch(i){e.handleFailure(t,i)}}})}}])&&e(a.prototype,u),o&&e(a,o),n}();exports.default=n});
//# sourceMappingURL=wait-in-parallel.min.js.map
